@using Microsoft.AspNetCore.Http.Extensions
@using Microsoft.Extensions.Primitives
@using Demosite.Infrastructure.TagHelpers
@using Demosite.Infrastructure
@using Demosite.Models.Pagination
@using System.IO

@model Demosite.Models.Pagination.PaginationViewModel


@if (Model.MaxValue > 1)
{
  <div class="pagination">
        @if (Model.Current > 1)
        {
            <div class="pagination__arrow pagination__arrow--prev"></div>
        }
        <ul class="pagination__list">
            <li class="pagination__list-item">
                <a href="@GetPageUrl(Model.Current - 1)"
               class="page-link @(Model.IsMovePreviousAvailable ? string.Empty : "disabled")"
               aria-label="Previous">
                    <span aria-hidden="true">«</span>
                </a>
            </li>

            @for (var pageNumber = Model.MinValue; pageNumber <= Model.MaxValue; pageNumber++)
            {
                <li class="page-item @(pageNumber == Model.Current ? "pagination__list-item--current" : string.Empty)" aria-current="page">
                    <a href="@GetPageUrl(pageNumber)" class="page-link">
                        <span aria-hidden="true">@pageNumber</span>
                    </a>
                </li>
            }

            <li class="page-item">
                <a href="@GetPageUrl(Model.Current + 1)"
               class="page-link @(Model.IsMoveNextAvailable ? string.Empty : "disabled")"
               aria-label="Next"><span aria-hidden="true">»</span></a>
            </li>
        </ul>
  </div>
   
}

@functions {
    public string GetPageUrl(int page)
    {
        if (page == Model.Current)
        {
            return "#";
        }

        return Model.BaseQuery
            .Add(Constants.BindNames.Pagination, page.ToString())
            .ToUriComponent();
    }
}
